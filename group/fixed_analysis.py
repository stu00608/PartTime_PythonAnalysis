import pandas as pd
import os
import re
import numpy as np

os.chdir("/Users/cilab/PartTime_PythonAnalysis/group")
#os.chdir(r"C:\Users\Naichen\Documents\GitHub\stu00608.github.io\PartTime_PythonAnalysis\group")
os.getcwd()

import ct_tool as ct

#記得路徑不同電腦要改

statData = pd.read_excel("003.xlsx",skiprows=4)
#statData = statData.dropna(axis=1,how='all')

os.chdir("/Users/cilab/PartTime_PythonAnalysis/group/outputs/analysis")
#os.chdir(r"C:\Users\Naichen\Documents\GitHub\stu00608.github.io\PartTime_PythonAnalysis\group\outputs\analysis")
os.getcwd()

#土木營建  建築、都市規劃 電子電機 資訊通訊 化工材料 生技醫工 環工綠能 機械 其他


#數字檢測(把float獨立出來檢查)
detectList = [ '2.單位總員工人數','土木營建領域專長 男性 專任 人數','建築、都市規劃領域專長 男性 專任 人數','電子電機領域專長 男性 專任 人數','資訊通訊領域專長 男性 專任 人數','化工材料領域專長 男性 專任 人數',
 '生技醫工領域專長 男性 專任 人數','環工綠能領域專長 男性 專任 人數','機械領域專長 男性 專任 人數','其他領域專長 男性 專任 人數','非工程與科技領域專長 男性 專任 人數',
 '土木營建領域專長 女性 專任 人數','建築、都市規劃領域專長 女性 專任 人數','電子電機領域專長 女性 專任 人數','資訊通訊領域專長 女性 專任 人數','化工材料領域專長 女性 專任 人數',
 '生技醫工領域專長 女性 專任 人數','環工綠能領域專長 女性 專任 人數','機械領域專長 女性 專任 人數','其他領域專長 女性 專任 人數','非工程與科技領域專長 女性 專任 人數',
 '服務年資1~5年','服務年資6~10年','服務年資11~15年','服務年資16~20年','服務年資16~20年.1','服務年資21~25年','服務年資25年以上',
 '服務年資1~5年.1','服務年資6~10年.1','服務年資11~15年.1','服務年資16~20年.2','服務年資21~25年.1' ,'服務年資25年以上.1',
 
 '服務年資1~5年.2',
 '服務年資6~10年.2',
 '服務年資11~15年.2',
 '服務年資16~20年.3',
 '服務年資21~25年.2',
 '服務年資25年以上.2',
 '服務年資1~5年.3',
 '服務年資6~10年.3',
 '服務年資11~15年.3',
 '服務年資16~20年.4',
 '服務年資21~25年.3',
 '服務年資25年以上.3',

 '服務年資1~5年.4',
 '服務年資6~10年.4',
 '服務年資11~15年.4',
 '服務年資16~20年.5',
 '服務年資21~25年.4',
 '服務年資25年以上.4',
 '服務年資1~5年.5',
 '服務年資6~10年.5',
 '服務年資11~15年.5',
 '服務年資16~20年.6',
 '服務年資21~25年.5',
 '服務年資25年以上.5',

 '服務年資1~5年.6',
 '服務年資6~10年.6',
 '服務年資11~15年.6',
 '服務年資16~20年.7',
 '服務年資21~25年.6',
 '服務年資25年以上.6',
 '服務年資1~5年.7',
 '服務年資6~10年.7',
 '服務年資11~15年.7',
 '服務年資16~20年.8',
 '服務年資21~25年.7',
 '服務年資25年以上.7',

 '服務年資1~5年.8',
 '服務年資6~10年.8',
 '服務年資11~15年.8',
 '服務年資16~20年.10',
 '服務年資21~25年.8',
 '服務年資25年以上.8',
 '服務年資1~5年.9',
 '服務年資6~10年.9',
 '服務年資11~15年.9',
 '服務年資16~20年.11',
 '服務年資21~25年.9',
 '服務年資25年以上.9',

 '服務年資1~5年.10',
 '服務年資6~10年.10',
 '服務年資11~15年.10',
 '服務年資16~20年.12',
 '服務年資21~25年.10',
 '服務年資25年以上.10',
 '服務年資1~5年.11',
 '服務年資6~10年.11',
 '服務年資11~15年.11',
 '服務年資16~20年.13',
 '服務年資21~25年.11',
 '服務年資25年以上.11',

 '服務年資1~5年.12',
 '服務年資6~10年.12',
 '服務年資11~15年.12',
 '服務年資16~20年.14',
 '服務年資21~25年.12',
 '服務年資25年以上.12',
 '服務年資1~5年.13',
 '服務年資6~10年.13',
 '服務年資11~15年.13',
 '服務年資16~20年.15',
 '服務年資21~25年.13',
 '服務年資25年以上.13',

 '服務年資1~5年.14',
 '服務年資6~10年.14',
 '服務年資11~15年.14',
 '服務年資16~20年.16',
 '服務年資21~25年.14',
 '服務年資25年以上.14',
 '服務年資1~5年.15',
 '服務年資6~10年.15',
 '服務年資11~15年.15',
 '服務年資16~20年.17',
 '服務年資21~25年.15',
 '服務年資21~25年.16',
 '服務年資25年以上.15',

 '服務年資1~5年.16',
 '服務年資6~10年.16',
 '服務年資11~15年.16',
 '服務年資16~20年.18',
 '服務年資21~25年.17',
 '服務年資25年以上.16',
 '服務年資1~5年.17',
 '服務年資6~10年.17',
 '服務年資11~15年.17',
 '服務年資16~20年.19',
 '服務年資21~25年.18',
 '服務年資25年以上.17',

 '管理職年資1~5年',
 '管理職年資6~10年',
 '管理職年資11~15年',
 '管理職年資16~20年',
 '管理職年資21~25年',
 '管理職年資25年以上',
 '管理職年資1~5年.1',
 '管理職年資6~10年.1',
 '管理職年資11~15年.1',
 '管理職年資16~20年.1',
 '管理職年資21~25年.1',
 '管理職年資25年以上.1',

 '管理職年資1~5年.2',
 '管理職年資6~10年.2',
 '管理職年資11~15年.2',
 '管理職年資16~20年.2',
 '管理職年資21~25年.2',
 '管理職年資25年以上.2',
 '管理職年資1~5年.3',
 '管理職年資6~10年.3',
 '管理職年資11~15年.3',
 '管理職年資16~20年.3',
 '管理職年資21~25年.3',
 '管理職年資25年以上.3',

 '管理職年資1~5年.4',
 '管理職年資6~10年.4',
 '管理職年資11~15年.4',
 '管理職年資16~20年.4',
 '管理職年資21~25年.4',
 '管理職年資25年以上.4',
 '管理職年資1~5年.5',
 '管理職年資6~10年.5',
 '管理職年資11~15年.5',
 '管理職年資16~20年.5',
 '管理職年資21~25年.5',
 '管理職年資25年以上.5',

 '管理職年資1~5年.6',
 '管理職年資6~10年.6',
 '管理職年資11~15年.6',
 '管理職年資16~20年.6',
 '管理職年資21~25年.6',
 '管理職年資25年以上.6',
 '管理職年資1~5年.7',
 '管理職年資6~10年.7',
 '管理職年資11~15年.7',
 '管理職年資16~20年.7',
 '管理職年資21~25年.7',
 '管理職年資25年以上.7',

 '管理職年資1~5年.8',
 '管理職年資6~10年.8',
 '管理職年資11~15年.8',
 '管理職年資16~20年.8',
 '管理職年資21~25年.8',
 '管理職年資25年以上.8',
 '管理職年資1~5年.9',
 '管理職年資6~10年.9',
 '管理職年資11~15年.9',
 '管理職年資16~20年.9',
 '管理職年資21~25年.9',
 '管理職年資25年以上.9',

 '管理職年資1~5年.11',
 '管理職年資6~10年.10',
 '管理職年資11~15年.10',
 '管理職年資16~20年.10',
 '管理職年資21~25年.10',
 '管理職年資25年以上.10',
 '管理職年資1~5年.12',
 '管理職年資6~10年.11',
 '管理職年資11~15年.11',
 '管理職年資16~20年.11',
 '管理職年資21~25年.11',
 '管理職年資25年以上.11',

 '管理職年資1~5年.13',
 '管理職年資6~10年.12',
 '管理職年資11~15年.12',
 '管理職年資16~20年.12',
 '管理職年資21~25年.12',
 '管理職年資25年以上.12',
 '管理職年資1~5年.14',
 '管理職年資6~10年.13',
 '管理職年資11~15年.13',
 '管理職年資16~20年.13',
 '管理職年資21~25年.13',
 '管理職年資25年以上.13',

 '管理職年資1~5年.15',
 '管理職年資6~10年.14',
 '管理職年資11~15年.14',
 '管理職年資16~20年.14',
 '管理職年資21~25年.14',
 '管理職年資25年以上.14',
 '管理職年資1~5年.16',
 '管理職年資6~10年.15',
 '管理職年資11~15年.15',
 '管理職年資16~20年.15',
 '管理職年資21~25年.15',
 '管理職年資25年以上.15',

 '管理職年資1~5年.17',
 '管理職年資6~10年.16',
 '管理職年資11~15年.16',
 '管理職年資16~20年.16',
 '管理職年資21~25年.16',
 '管理職年資25年以上.16',
 '管理職年資1~5年.18',
 '管理職年資6~10年.17',
 '管理職年資11~15年.17',
 '管理職年資16~20年.17',
 '管理職年資21~25年.17',
 '管理職年資25年以上.17',
 #0
 '35歲以下',
 '36-45歲',
 '46-55歲',
 '56-65歲',
 '66歲以上',
 '35歲以下.1',
 '36-45歲.1',
 '46-55歲.1',
 '56-65歲.1',
 '66歲以上.1',
#1
 '35歲以下.2',
 '36-45歲.2',
 '46-55歲.2',
 '56-65歲.2',
 '66歲以上.2',
 '35歲以下.3',
 '36-45歲.3',
 '46-55歲.3',
 '56-65歲.3',
 '66歲以上.3',
#2
 '35歲以下.4',
 '36-45歲.4',
 '46-55歲.4',
 '56-65歲.4',
 '66歲以上.4',
 '35歲以下.5',
 '36-45歲.5',
 '46-55歲.5',
 '56-65歲.5',
 '66歲以上.5',
#3
 '35歲以下.6',
 '36-45歲.6',
 '46-55歲.6',
 '56-65歲.6',
 '66歲以上.6',
 '35歲以下.7',
 '36-45歲.7',
 '46-55歲.7',
 '56-65歲.7',
 '66歲以上.7',
#4
 '35歲以下.8',
 '36-45歲.8',
 '46-55歲.8',
 '56-65歲.8',
 '66歲以上.8',
 '35歲以下.9',
 '36-45歲.9',
 '46-55歲.9',
 '56-65歲.9',
 '66歲以上.9',
#5
 '35歲以下.10',
 '36-45歲.10',
 '46-55歲.10',
 '56-65歲.10',
 '66歲以上.10',
 '35歲以下.11',
 '36-45歲.11',
 '46-55歲.11',
 '56-65歲.11',
 '66歲以上.11',
#6
 '35歲以下.12',
 '36-45歲.12',
 '46-55歲.12',
 '56-65歲.12',
 '66歲以上.12',
 '35歲以下.13',
 '36-45歲.13',
 '46-55歲.13',
 '56-65歲.13',
 '66歲以上.13',
#7
 '35歲以下.14',
 '36-45歲.14',
 '46-55歲.14',
 '56-65歲.14',
 '66歲以上.14',
 '35歲以下.15',
 '36-45歲.15',
 '46-55歲.15',
 '56-65歲.15',
 '66歲以上.15',
#8
 '35歲以下.16',
 '36-45歲.16',
 '46-55歲.16',
 '56-65歲.16',
 '66歲以上.16',
 '35歲以下.17',
 '36-45歲.17',
 '56-65歲.17',
 '66歲以上.17',
#9
 '35歲以下.18',
 '36-45歲.18',
 '46-55歲.17',
 '56-65歲.18',
 '66歲以上.18',
 '35歲以下.19',
 '36-45歲.19',
 '46-55歲.18',
 '56-65歲.19',
 '66歲以上.19',
#0
 '35歲以下.20',
 '36-45歲.20',
 '46-55歲.19',
 '56-65歲.20',
 '66歲以上.20',
 '35歲以下.21',
 '36-45歲.21',
 '46-55歲.20',
 '56-65歲.21',
 '66歲以上.21',
#1
 '35歲以下.22',
 '36-45歲.22',
 '46-55歲.21',
 '56-65歲.22',
 '66歲以上.22',
 '35歲以下.23',
 '36-45歲.23',
 '46-55歲.22',
 '56-65歲.23',
 '66歲以上.23',
#2
 '35歲以下.24',
 '36-45歲.24',
 '46-55歲.23',
 '56-65歲.24',
 '66歲以上.24',
 '35歲以下.25',
 '36-45歲.25',
 '46-55歲.24',
 '56-65歲.25',
 '66歲以上.25',
#3
 '35歲以下.26',
 '36-45歲.26',
 '46-55歲.25',
 '56-65歲.26',
 '66歲以上.26',
 '35歲以下.27',
 '36-45歲.27',
 '46-55歲.26',
 '56-65歲.27',
 '66歲以上.27',
 #4
 '35歲以下.28',
 '36-45歲.28',
 '46-55歲.27',
 '56-65歲.28',
 '66歲以上.28',
 '35歲以下.29',
 '36-45歲.29',
 '46-55歲.28',
 '56-65歲.29',
 '66歲以上.29',
 #5
 '35歲以下.30',
 '36-45歲.30',
 '46-55歲.29',
 '56-65歲.30',
 '66歲以上.30',
 '35歲以下.31',
 '36-45歲.31',
 '46-55歲.30',
 '56-65歲.31',
 '66歲以上.31',
 #6
 '35歲以下.32',
 '36-45歲.32',
 '46-55歲.31',
 '56-65歲.32',
 '66歲以上.32',
 '35歲以下.33',
 '36-45歲.33',
 '46-55歲.32',
 '56-65歲.33',
 '66歲以上.33',
 #7
 '35歲以下.34',
 '36-45歲.34',
 '46-55歲.33',
 '56-65歲.34',
 '66歲以上.34',
 '35歲以下.35',
 '36-45歲.35',
 '46-55歲.34',
 '56-65歲.35',
 '66歲以上.35',
 #8
 '35歲以下.36',
 '36-45歲.36',
 '46-55歲.35',
 '56-65歲.36',
 '66歲以上.36',
 '35歲以下.37',
 '36-45歲.37',
 '46-55歲.36',
 '56-65歲.37',
 '66歲以上.37',
 #9
 '35歲以下.38',
 '36-45歲.38',
 '46-55歲.37',
 '56-65歲.38',
 '66歲以上.38',
 '35歲以下.39',
 '36-45歲.39',
 '46-55歲.38',
 '56-65歲.39',
 '66歲以上.39',
 #0
 '35歲以下.40',
 '36-45歲.40',
 '45-55歲',
 '56-65歲.40',
 '66歲以上.40',
 '35歲以下.41',
 '36-45歲.41',
 '46-55歲.39',
 '56-65歲.41',
 '66歲以上.41',
 #1
 '35歲以下.42',
 '36-45歲.42',
 '46-55歲.40',
 '56-65歲.42',
 '66歲以上.42',
 '35歲以下.43',
 '36-45歲.43',
 '46-55歲.41',
 '56-65歲.43',
 '66歲以上.43',
 #2
 '35歲以下.44',
 '36-45歲.44',
 '46-55歲.42',
 '56-65歲.44',
 '66歲以上.44',
 '35歲以下.45',
 '36-45歲.45',
 '46-55歲.43',
 '56-65歲.45',
 '66歲以上.45',
 #3
 '35歲以下.46',
 '36-45歲.46',
 '46-55歲.44',
 '56-65歲.46',
 '66歲以上.46',
 '35歲以下.47',
 '36-45歲.47',
 '46-55歲.45',
 '56-65歲.47',
 '66歲以上.47',
 #4
 '35歲以下.48',
 '36-45歲.48',
 '46-55歲.46',
 '56-65歲.48',
 '66歲以上.48',
 '35歲以下.49',
 '36-45歲.49',
 '46-55歲.47',
 '56-65歲.49',
 '66歲以上.49',
 #5
 '35歲以下.50',
 '36-45歲.50',
 '46-55歲.48',
 '56-65歲.50',
 '66歲以上.50',
 '35歲以下.51',
 '36-45歲.51',
 '46-55歲.49',
 '56-65歲.51',
 '66歲以上.51',
 #6
 '35歲以下.52',
 '36-45歲.52',
 '46-55歲.50',
 '56-65歲.52',
 '66歲以上.52',
 '35歲以下.53',
 '36-45歲.53',
 '46-55歲.51',
 '56-65歲.53',
 '66歲以上.53',
 #7
 '35歲以下.54',
 '36-45歲.54',
 '46-55歲.52',
 '56-65歲.54',
 '66歲以上.54',
 '35歲以下.55',
 '36-45歲.55',
 '46-55歲.53',
 '56-65歲.55',
 '66歲以上.55',
 #8
 '35歲以下.56',
 '36-45歲.56',
 '46-55歲.54',
 '56-65歲.56',
 '66歲以上.56',
 '35歲以下.57',
 '36-45歲.57',
 '46-55歲.55',
 '56-65歲.57',
 '66歲以上.57',
 #9
 '35歲以下.58',
 '36-45歲.58',
 '46-55歲.56',
 '56-65歲.58',
 '66歲以上.58',
 '35歲以下.59',
 '36-45歲.59',
 '46-55歲.57',
 '56-65歲.59',
 '66歲以上.59',

 '35歲以下.60',
 '36-45歲.60',
 '46-55歲.58',
 '56-65歲.60',
 '66歲以上.60',
 '35歲以下.61',
 '36-45歲.61',
 '46-55歲.59',
 '56-65歲.61',
 '66歲以上.61',

 '35歲以下.62',
 '36-45歲.62',
 '46-55歲.60',
 '56-65歲.62',
 '66歲以上.62',
 '35歲以下.63',
 '36-45歲.63',
 '46-55歲.61',
 '56-65歲.63',
 '66歲以上.63',
 '35歲以下.64',
 '36-45歲.64',
 '46-55歲.62',
 '56-65歲.64',
 '66歲以上.64',
 '35歲以下.65',
 '36-45歲.65',
 '46-55歲.63',
 '56-65歲.65',
 '66歲以上.65',
 '35歲以下.66',
 '36-45歲.66',
 '46-55歲.64',
 '56-65歲.66',
 '66歲以上.66',
 '35歲以下.67',
 '36-45歲.67',
 '46-55歲.65',
 '56-65歲.67',
 '66歲以上.67',
 '35歲以下.68',
 '36-45歲.68',
 '46-55歲.66',
 '56-65歲.68',
 '66歲以上.68',
 '35歲以下.69',
 '36-45歲.69',
 '46-55歲.67',
 '56-65歲.69',
 '66歲以上.69',
 '35歲以下.70',
 '36-45歲.70',
 '46-55歲.68',
 '56-65歲.70',
 '66歲以上.70',
 '35歲以下.71',
 '36-45歲.71',
 '46-55歲.69',
 '56-65歲.71',
 '66歲以上.71',
 '35歲以下.72',
 '36-45歲.72',
 '46-55歲.70',
 '56-65歲.72',
 '66歲以上.72',
 '35歲以下.73',
 '36-45歲.73',
 '46-55歲.71',
 '56-65歲.73',
 '66歲以上.73',
 '35歲以下.74',
 '36-45歲.74',
 '46-55歲.72',
 '56-65歲.74',
 '66歲以上.74',
 '35歲以下.75',
 '36-45歲.75',
 '46-55歲.73',
 '56-65歲.75',
 '66歲以上.75',
 '35歲以下.76',
 '36-45歲.76',
 '46-55歲.74',
 '56-65歲.76',
 '66歲以上.76',
 '35歲以下.77',
 '36-45歲.77',
 '46-55歲.75',
 '56-65歲.77',
 '66歲以上.77',
 '35歲以下.78',
 '36-45歲.78',
 '46-55歲.76',
 '56-65歲.78',
 '66歲以上.78',
 '35歲以下.79',
 '36-45歲.79',
 '46-55歲.77',
 '56-65歲.79',
 '66歲以上.79',
 '36歲以下',
 '36-45歲.80',
 '46-55歲.78',
 '56-65歲.80',
 '66歲以上.80',
 '35歲以下.80',
 '36-45歲.81',
 '46-55歲.79',
 '56-65歲.81',
 '66歲以上.81',
 '35歲以下.81',
 '36-45歲.82',
 '46-55歲.80',
 '56-65歲.82',
 '66歲以上.82',
 '35歲以下.82',
 '36-45歲.83',
 '46-55歲.81',
 '56-65歲.83',
 '66歲以上.83',
 '35歲以下.83',
 '36-45歲.84',
 '46-55歲.82',
 '56-65歲.84',
 '66歲以上.84',
 '35歲以下.84',
 '36-45歲.85',
 '46-55歲.83',
 '56-65歲.85',
 '66歲以上.85',
 '35歲以下.85',
 '36-45歲.86',
 '46-55歲.84',
 '56-65歲.86',
 '66歲以上.86',
 '35歲以下.86',
 '36-45歲.87',
 '46-55歲.85',
 '56-65歲.87',
 '66歲以上.87',
 '35歲以下.87',
 '36-45歲.88',
 '46-55歲.86',
 '56-65歲.88',
 '66歲以上.88',
 '35歲以下.88',
 '36-45歲.89',
 '46-55歲.87',
 '56-65歲.89',
 '66歲以上.89',
 '35歲以下.89',
 '36-45歲.90',
 '46-55歲.88',
 '56-65歲.90',
 '66歲以上.90',
 '35歲以下.90',
 '36-45歲.91',
 '46-55歲.89',
 '56-65歲.91',
 '66歲以上.91',
 '35歲以下.91',
 '36-45歲.92',
 '46-55歲.90',
 '56-65歲.92',
 '66歲以上.92',
 '35歲以下.92',
 '36-45歲.93',
 '46-55歲.91',
 '56-65歲.93',
 '66歲以上.93',
 '35歲以下.93',
 '36-45歲.94',
 '46-55歲.92',
 '56-65歲.94',
 '66歲以上.94',
 '35歲以下.94',
 '36-45歲.95',
 '46-55歲.93',
 '56-65歲.95',
 '66歲以上.95',
 '35歲以下.95',
 '36-45歲.96',
 '46-55歲.94',
 '56-65歲.96',
 '66歲以上.96',
 '35歲以下.96',
 '36-45歲.97',
 '46-55歲.95',
 '56-65歲.97',
 '66歲以上.97',
 '35歲以下.97',
 '36-45歲.98',
 '46-55歲.96',
 '56-65歲.98',
 '66歲以上.98',
 '35歲以下.98',
 '36-45歲.99',
 '46-55歲.97',
 '56-65歲.99',
 '66歲以上.99',
 '35歲以下.99',
 '36-45歲.100',
 '46-55歲.98',
 '56-65歲.100',
 '66歲以上.100',
 '35歲以下.100',
 '36-45歲.101',
 '46-55歲.99',
 '56-65歲.101',
 '66歲以上.101',
 '35歲以下.101',
 '36-45歲.102',
 '46-55歲.100',
 '56-65歲.102',
 '66歲以上.102',
 '35歲以下.102',
 '36-45歲.103',
 '46-55歲.101',
 '56-65歲.103',
 '66歲以上.103',
 '35歲以下.103',
 '36-45歲.104',
 '46-55歲.102',
 '56-65歲.104',
 '66歲以上.104',
 '35歲以下.104',
 '36-45歲.105',
 '46-55歲.103',
 '56-65歲.105',
 '66歲以上.105',
 '35歲以下.105',
 '36-45歲.106',
 '46-55歲.104',
 '56-65歲.106',
 '66歲以上.106',
 '35歲以下.106',
 '36-45歲.107',
 '46-55歲.105',
 '56-65歲.107',
 '66歲以上.107',
 '106年 請假人次',
 '107年  請假人次',
 '108年 請假人次',
 '106年  請假人次',
 '107年  請假人次.1',
 '108年  請假人次',
 '106年  請假人次.1',
 '107年  請假人次.2',
 '108年  請假人次.1',
 '106年  請假人次.2','107年  請假人次.3','108年  請假人次.2']
boolList = statData[detectList].isna()
for columns in detectList:     
    for i in range(len(statData.index)):
        if(not boolList[columns][i]):
            temp = statData[columns][i]
            if(str(temp).isdigit()):
                temp = int(temp)
            elif(re.sub('\D','',str(temp))==''):
                temp = 0
            elif(str(temp).find('.')>=0):
                temp = int(temp)
            else:
                temp = int(re.sub('\D','',str(temp)))
            statData.loc[i,columns] = temp
            # 1.0 10 'xxx' '10x'
        else:
            statData.loc[i,columns] = 0

for i in range(len(statData['1.單位名稱'])):
    if(   str(statData['1.單位名稱'][i]).find('經濟部水利署') != -1 ):
        statData.loc[i,'1.單位名稱']='經濟部水利署'
    elif( str(statData['1.單位名稱'][i]).find('公路總局') != -1 ):
        statData.loc[i,'1.單位名稱']='交通部公路總局'
    elif( str(statData['1.單位名稱'][i]).find('台灣電力') != -1 ):
        statData.loc[i,'1.單位名稱']='台灣電力股份有限公司'

num = ['100人以下','100~1000人','1000~10000人','10000人以上']

for i in range(len(statData)):
    v1 = int(statData['2.單位總員工人數'][i])
    if( v1<=100 and v1>=0) :
        statData.loc[i,'2.單位總員工人數'] = num[0]
    elif( v1>100 and v1<1000 ):
        statData.loc[i,'2.單位總員工人數'] = num[1]
    elif( v1>1000 and v1<10000 ):
        statData.loc[i,'2.單位總員工人數'] = num[2]
    elif( v1>10000 ):
        statData.loc[i,'2.單位總員工人數'] = num[3]
    else:
        statData.loc[i,'2.單位總員工人數']=None


colname = [ ['男性','男性','男性','男性','男性','男性','女性','女性','女性','女性','女性','女性',],['1~5年','6~10年','11~15年','16~20年','21~25年','25年以上','1~5年',
 '6~10年','11~15年','16~20年','21~25年','25年以上'] ]
colname2 = [ ['初階管理職','初階管理職','初階管理職','初階管理職','初階管理職','中階管理職','中階管理職','中階管理職','中階管理職','中階管理職','高階管理職','高階管理職','高階管理職','高階管理職','高階管理職',],
['35歲以下','36-45歲','46-55歲','56-65歲','66歲以上','35歲以下','36-45歲','46-55歲','56-65歲','66歲以上','35歲以下','36-45歲','46-55歲','56-65歲','66歲以上',] ]



#土木營建

df = statData[['1.單位名稱','2.單位總員工人數','土木營建','土木營建領域專長 男性 專任 人數','土木營建領域專長 女性 專任 人數','服務年資1~5年',
 '服務年資6~10年','服務年資11~15年','服務年資16~20年','服務年資21~25年','服務年資25年以上','服務年資1~5年.1',
 '服務年資6~10年.1','服務年資11~15年.1','服務年資16~20年.2','服務年資21~25年.1','服務年資25年以上.1','管理職年資1~5年',
 '管理職年資6~10年','管理職年資11~15年','管理職年資16~20年','管理職年資21~25年','管理職年資25年以上','管理職年資1~5年.1',
 '管理職年資6~10年.1','管理職年資11~15年.1','管理職年資16~20年.1','管理職年資21~25年.1','管理職年資25年以上.1',
 '35歲以下',
 '36-45歲',
 '46-55歲',
 '56-65歲',
 '66歲以上',
 '35歲以下.1',
 '36-45歲.1',
 '46-55歲.1',
 '56-65歲.1',
 '66歲以上.1',

 '35歲以下.20',
 '36-45歲.20',
 '46-55歲.19',
 '56-65歲.20',
 '66歲以上.20',
 '35歲以下.21',
 '36-45歲.21',
 '46-55歲.20',
 '56-65歲.21',
 '66歲以上.21',

 '35歲以下.40',
 '36-45歲.40',
 '45-55歲',
 '56-65歲.40',
 '66歲以上.40',
 '35歲以下.41',
 '36-45歲.41',
 '46-55歲.39',
 '56-65歲.41',
 '66歲以上.41']]

df = df.dropna(subset=['土木營建'],axis=0)

col = ['土木營建領域專長 男性 專任 人數','土木營建領域專長 女性 專任 人數','服務年資1~5年',
 '服務年資6~10年','服務年資11~15年','服務年資16~20年','服務年資21~25年','服務年資25年以上','服務年資1~5年.1',
 '服務年資6~10年.1','服務年資11~15年.1','服務年資16~20年.2','服務年資21~25年.1','服務年資25年以上.1','管理職年資1~5年',
 '管理職年資6~10年','管理職年資11~15年','管理職年資16~20年','管理職年資21~25年','管理職年資25年以上','管理職年資1~5年.1',
 '管理職年資6~10年.1','管理職年資11~15年.1','管理職年資16~20年.1','管理職年資21~25年.1','管理職年資25年以上.1']
result = pd.DataFrame(columns=col)


for name in num:
    df1 = ct.group_table(df,'2.單位總員工人數',[name])
    df1 = pd.DataFrame(data=df1[col].sum(),columns=[name])
    result.loc[name]=list(df1[name])

result.index.name='單位總員工人數'


r1 = result[['土木營建領域專長 男性 專任 人數','土木營建領域專長 女性 專任 人數']]
r1.columns=['男性','女性']
r1.columns.names=['土木營建領域專任人數']
r1.to_csv('土木營建領域專任人數.csv',encoding='utf_8_sig')

r2 = result[['服務年資1~5年','服務年資6~10年','服務年資11~15年','服務年資16~20年','服務年資21~25年','服務年資25年以上','服務年資1~5年.1',
 '服務年資6~10年.1','服務年資11~15年.1','服務年資16~20年.2','服務年資21~25年.1','服務年資25年以上.1']]
r2.columns=colname
r2.columns.names=['性別','土木營建領域服務年資']

r3 = result[['管理職年資1~5年','管理職年資6~10年','管理職年資11~15年','管理職年資16~20年','管理職年資21~25年','管理職年資25年以上','管理職年資1~5年.1',
'管理職年資6~10年.1','管理職年資11~15年.1','管理職年資16~20年.1','管理職年資21~25年.1','管理職年資25年以上.1']]
r3.columns = colname
r3.columns.names=['性別','土木營建領域管理職年資']

r2.to_csv('土木營建領域服務年資.csv',encoding='utf_8_sig')
r3.to_csv('土木營建領域管理職年資.csv',encoding='utf_8_sig')

#各階管理職人員人數
r4 = result[['35歲以下',
 '36-45歲',
 '46-55歲',
 '56-65歲',
 '66歲以上',
 '35歲以下.1',
 '36-45歲.1',
 '46-55歲.1',
 '56-65歲.1',
 '66歲以上.1',

 '35歲以下.20',
 '36-45歲.20',
 '46-55歲.19',
 '56-65歲.20',
 '66歲以上.20',
 '35歲以下.21',
 '36-45歲.21',
 '46-55歲.20',
 '56-65歲.21',
 '66歲以上.21',

 '35歲以下.40',
 '36-45歲.40',
 '45-55歲',
 '56-65歲.40',
 '66歲以上.40',
 '35歲以下.41',
 '36-45歲.41',
 '46-55歲.39',
 '56-65歲.41',
 '66歲以上.41']]
r4.columns = colname2
r4.columns.names=[]


#建築、都市規劃

df = statData[ ['建築、都市規劃領域專長 男性 專任 人數','建築、都市規劃領域專長 女性 專任 人數','服務年資1~5年.2',
'服務年資6~10年.2','服務年資11~15年.2','服務年資16~20年.3','服務年資21~25年.2','服務年資25年以上.2', '服務年資6~10年.3',
'服務年資11~15年.3','服務年資16~20年.4','服務年資21~25年.3','服務年資25年以上.3','管理職年資1~5年.2','管理職年資6~10年.2',
'管理職年資11~15年.2','管理職年資16~20年.2','管理職年資21~25年.2','管理職年資25年以上.2','管理職年資1~5年.3','管理職年資6~10年.3',
'管理職年資11~15年.3','管理職年資16~20年.3','管理職年資21~25年.3','管理職年資25年以上.3',] ]



#電子電機

#資訊通訊

#化工材料

#生技醫工